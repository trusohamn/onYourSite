const getData = process.env.NODE_ENV === 'production' ? findEntry : findEntryMock;

const MongoClient = require('mongodb').MongoClient;
const url = process.env.MONGOLAB_URI;

function findEntry(key, callback) {
    console.log('looging for:', key);
    MongoClient.connect(url, function (err, db) {
        if (err) throw err;
        var dbo = db.db("mydb");
        dbo.collection("test").find({ _id: key }).toArray(function (err, result) {
            if (err) throw err;
            db.close();
            console.log(result);
            callback(result[0]);
        });
    });
}

function findEntryMock(key, callback) {
    console.log('sending mock data');
    const result =
        { "_id": "7", 
        "name": "mana", 
        "surname": "nana", 
        "imageUrl": "data:image/jpeg;base64,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", 
        "styles": "red.css" }
    callback(result);
}

module.exports.getData = getData;